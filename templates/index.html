<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>247FILE SHARE</title>
  <link rel="icon" href="{{ request.url_for('static', path='logo.svg') }}" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Space+Grotesk:wght@400;500;600;700&family=Fraunces:wght@600;700;800&display=swap" rel="stylesheet" />
  <link rel="icon" href="{{ request.url_for('static', path='favicon.png') }}" />
  <link rel="stylesheet" href="{{ request.url_for('static', path='styles.css') }}" />
  <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
  <script src="https://unpkg.com/pdfjs-dist@2.16.105/build/pdf.min.js"></script>
</head>
<body>
  {% include '_header.html' %}

  {% set cu = (current_user if (current_user is defined and current_user) else (request.state.current_user if request and request.state else None)) %}
  {% if cu %}
  <!-- Category chips (clickable) -->
  {% set current_category = request.query_params.get('category', '') %}
  <section class="container category-bar" style="margin-top:12px;">
    <div style="display:flex;flex-direction:column;gap:8px;">
      <div class="suggested-chips">
        {% set suggested = ['For You','Business','Mobile'] %}
        {% for s in suggested %}
          <a class="suggested-chip{% if s == (current_category or 'For You') %} active{% endif %}" href="/search?category={{ s|url_encode }}">{{ s }}</a>
        {% endfor %}
      </div>
      <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;">
        <div id="category-scroll" class="category-scroll" role="list">
          {% for c in request.state.categories or [] %}
            <a role="listitem" data-cat="{{ c }}" class="category-chip{% if c == current_category %} active{% endif %}" href="/search?category={{ c|url_encode }}">{{ c }}</a>
          {% endfor %}
        </div>
        <a class="muted" href="/categories" style="font-weight:700;text-decoration:none;">Show all categories ‚ñæ</a>
      </div>
    </div>
  </section>

  <script src="{{ request.url_for('static', path='js/categories.js') }}" defer></script>
  {% endif %}

  {% if current_user %}
  <div class="signed-in-ribbon">
    <div class="container ribbon-inner">
      <span class="pill pill--tiny">New</span>
      <div>
        <div class="ribbon-title">upload upload upload!</div>
        <a class="muted" href="about.html">Learn more about us.</a>
      </div>
    </div>
  </div>
  {% endif %}

  {% if my_uploads and my_uploads|length > 0 %}
  <section class="container" style="margin-top:18px;">
    <h3>Your uploads <span class="muted" style="font-size:14px; font-weight:600;">({{ my_upload_count or (my_uploads|length) }})</span></h3>
    <div class="gallery-grid" style="margin-top:10px;">
      {% for p in my_uploads %}
      <div class="gallery-card">
        <div style="height:120px; display:flex; align-items:center; justify-content:center; background:linear-gradient(135deg, rgba(14,165,233,0.06), rgba(249,115,22,0.04));">
          <div style="font-weight:800;">{{ p.title[:40] }}</div>
        </div>
        <div class="gallery-meta">
          <div style="flex:1">
            <div style="font-weight:700">{{ p.title }}</div>
            <div class="muted" style="font-size:13px;">{{ p.created_at.strftime('%Y-%m-%d') }} ‚Ä¢ {{ p.mimetype or 'file' }}</div>
          </div>
          <div style="display:flex; align-items:center; gap:8px;">
            <a class="btn btn--ghost" href="{{ url_for('view_presentation', presentation_id=p.id) }}">View</a>
            <a class="btn" href="{{ url_for('download_file', filename=p.filename) }}">Download</a>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </section>
  
  {% if featured and featured|length > 0 %}
  <section class="container" style="margin-top:18px;">
    <div class="panel-head">
      <h3 class="section-title">Featured presentations</h3>
      <p class="muted">Curated and spotlighted decks ‚Äî slide through the selection.</p>
    </div>
    <div class="featured-carousel">
      <div class="featured-nav" style="left:8px;">
        <button id="featured-prev" class="prev" aria-label="Scroll left">‚óÄ</button>
      </div>
      <div class="featured-track" id="featured-track" data-carousel>
        {% for p in featured %}
        <article class="featured-card card" data-pid="{{ p.id }}">
          <a class="card__link" href="{{ url_for('view_presentation', presentation_id=p.id) }}">
            <div class="card__thumb">
              {% set is_pdf = p.filename and p.filename.lower().endswith('.pdf') %}
              {% set slide_thumb = '/presentations/' ~ p.id ~ '/slide/0' %}
              {% if is_pdf %}
                <iframe class="thumb-frame" src="/download/{{ p.filename }}?inline=1#page=1&view=FitH&toolbar=0&navpanes=0" loading="lazy"></iframe>
              {% else %}
                <img src="{{ slide_thumb }}" alt="{{ p.title }}" loading="lazy" onerror="this.onerror=null;this.src='{{ request.url_for('static', path='slide-placeholder.svg') }}'" />
              {% endif %}
            </div>
            <div class="card__body">
              <h4>{{ p.title }}</h4>
              <p class="muted">by {% if p.owner_username %}<a href="/users/{{ p.owner_username }}">{{ p.owner_username }}</a>{% else %}{{ p.author or 'Unknown' }}{% endif %} ¬∑ {{ p.views or 0 }} views</p>
            </div>
          </a>
          <div class="card__actions">
            {% if p.owner_id %}
              <button class="btn btn--ghost btn-contact" data-user-id="{{ p.owner_id }}" data-username="{{ p.owner_username }}" data-email="{{ p.owner_email }}">Contact Owner</button>
            {% endif %}
            {% if p.filename %}
              <a class="btn" href="{{ url_for('download_file', filename=p.filename) }}">Download</a>
            {% endif %}
          </div>
        </article>
        {% endfor %}
      </div>
      <div class="featured-nav" style="right:8px;">
        <button id="featured-next" class="next" aria-label="Scroll right">‚ñ∂</button>
      </div>
    </div>
  </section>
  {% endif %}

  <!-- Community uploads visible to signed-in users -->
  {% if most_viewed and most_viewed|length > 0 %}
  <section class="container" style="margin-top:18px;">
    <div class="panel-head">
      <h3 class="section-title">Most viewed</h3>
      <p class="muted">Top presentations by views</p>
    </div>
    <div class="grid" style="grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:12px; margin-top:10px;">
      {% for m in most_viewed %}
      <article class="card" data-pid="{{ m.id }}">
        <a href="{{ url_for('view_presentation', presentation_id=m.id) }}" class="card__link">
          {% set is_pdf = m.filename and m.filename.lower().endswith('.pdf') %}
          {% set slide_thumb = '/presentations/' ~ m.id ~ '/slide/0' %}
          {% set thumb_pdf = '/download/' ~ m.filename ~ '?inline=1#page=1&view=FitH&toolbar=0&navpanes=0' if is_pdf else None %}
          <div class="card__thumb" style="height:120px;display:flex;align-items:center;justify-content:center;">
            {% if is_pdf %}
              <iframe class="thumb-frame" src="{{ thumb_pdf }}" title="{{ m.title }} preview" loading="lazy"></iframe>
              {% else %}
              <img src="{{ slide_thumb }}" alt="{{ m.title }}" loading="lazy" data-cover="{{ m.cover_url or '' }}" data-placeholder="{{ request.url_for('static', path='slide-placeholder.svg') }}" onerror="this.onerror=null;this.src='{{ request.url_for('static', path='slide-placeholder.svg') }}'" style="width:100%;height:100%;object-fit:cover;" />
            {% endif %}
          </div>
          <div class="card__body">
            <h4>{{ m.title }}</h4>
            <p class="muted">by {% if m.owner_username %}<a href="/users/{{ m.owner_username }}">{{ m.owner_username }}</a>{% else %}{{ m.author or 'Unknown' }}{% endif %} ¬∑ {{ m.views or 0 }} views</p>
          </div>
        </a>
      </article>
      {% endfor %}
    </div>
  </section>
  {% endif %}
  <section class="container community-uploads" style="margin-top:18px;">
    <div class="panel-head">
      <h3 class="section-title">Community uploads</h3>
      <p class="muted">A live feed of recent uploads from creators across the site.</p>
    </div>
    <div class="grid" style="grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:12px; margin-top:10px;">
      {% for pres in presentations[:12] %}
      {% set is_pdf = pres.filename and pres.filename.lower().endswith('.pdf') %}
      {% set slide_thumb = '/presentations/' ~ pres.id ~ '/slide/0' %}
      {% set thumb_pdf = '/download/' ~ pres.filename ~ '?inline=1#page=1&view=FitH&toolbar=0&navpanes=0' if is_pdf else None %}
      {% set thumb_url = pres.cover_url or thumb_pdf or request.url_for('static', path='slide-placeholder.svg') %}
      <article class="card" data-pid="{{ pres.id }}">
        <a href="{{ url_for('view_presentation', presentation_id=pres.id) }}" class="card__link">
          <div class="card__thumb">
            {% if is_pdf %}
              <iframe class="thumb-frame" src="{{ thumb_url }}" title="{{ pres.title }} preview" loading="lazy"></iframe>
              {% else %}
              <img src="{{ slide_thumb }}" alt="{{ pres.title }}" loading="lazy" data-cover="{{ pres.cover_url or '' }}" data-placeholder="{{ request.url_for('static', path='slide-placeholder.svg') }}" onerror="this.onerror=null;this.src='{{ (pres.cover_url or request.url_for('static', path='slide-placeholder.svg')) }}'" style="width:100%;height:100%;object-fit:cover;" />
            {% endif %}
            <div class="card__bookmark" data-id="{{ pres.id }}" title="Save">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path></svg>
            </div>
          </div>
          <div class="card__body">
            <h4>{{ pres.title }}</h4>
            <p class="muted">by {% if pres.owner_username %}<a href="/users/{{ pres.owner_username }}">{{ pres.owner_username }}</a>{% else %}{{ (('User ' ~ pres.owner_id) if pres.owner_id else (pres.author or 'Unknown')) }}{% endif %}</p>
          </div>
        </a>
        <div class="card__actions">
          {% set cu = current_user if current_user else None %}
          {% if pres.owner_id %}
            <button class="btn btn--ghost btn-contact" data-user-id="{{ pres.owner_id }}" data-username="{{ pres.owner_username }}" data-email="{{ pres.owner_email }}">Contact Owner</button>
            {% if current_user and current_user.id != pres.owner_id %}
              {% if pres.is_following %}
                <form class="follow-form" data-owner-id="{{ pres.owner_id }}" method="post" action="/users/{{ pres.owner_id }}/unfollow" style="display:inline">
                  <button class="btn btn--ghost btn-follow">Unsubscribe</button>
                </form>
              {% else %}
                <form class="follow-form" data-owner-id="{{ pres.owner_id }}" method="post" action="/users/{{ pres.owner_id }}/follow" style="display:inline">
                  <button class="btn btn--ghost btn-follow">Subscribe</button>
                </form>
              {% endif %}
              <span class="muted followers-count" data-owner-id="{{ pres.owner_id }}" style="margin-left:8px; font-size:13px;">{{ pres.followers_count or 0 }} followers</span>
            {% else %}
              <form method="post" action="/users/{{ pres.owner_id }}/follow" style="display:inline">
                <button class="btn btn--ghost">Subscribe</button>
              </form>
            {% endif %}
          {% elif pres.owner_email %}
            <button class="btn btn--ghost btn-contact" data-user-id="" data-username="" data-email="{{ pres.owner_email }}">Contact Owner</button>
          {% endif %}
          <button class="btn btn--ghost btn-share" data-title="{{ pres.title }}" data-id="{{ pres.id }}" data-filename="{{ pres.filename }}">Share</button>
          {% if pres.owner_id and current_user and pres.owner_id != current_user.id %}
          <button class="btn btn--ghost btn-message" data-user-id="{{ pres.owner_id }}" data-username="{{ pres.owner_username }}">
            Message <span class="msg-badge" data-user-id="{{ pres.owner_id }}" style="margin-left:6px;display:inline-block"></span>
            <span class="presence-dot" data-user-id="{{ pres.owner_id }}" style="margin-left:6px;display:inline-block;width:8px;height:8px;border-radius:50%;background:#ccc"></span>
          </button>
          {% endif %}
          {% if pres.filename %}
          <a class="btn" href="{{ url_for('download_file', filename=pres.filename) }}">Download</a>
          {% endif %}
        </div>
      </article>
      {% else %}
      <p class="muted">No community uploads yet ‚Äî be the first!</p>
      {% endfor %}
    </div>
  </section>
  {% endif %}

  <section class="home-banner">
    <div class="container home-banner__inner">
      <div class="home-banner__copy">
        <p class="pill pill--tiny" style="margin:0;">Spotlight</p>
        <h2 class="home-banner__title">Share your next big idea with the world.</h2>
        <p class="home-banner__subtitle">Upload in seconds, get a gorgeous preview, and offer instant downloads to your audience.</p>
        <div class="home-banner__actions">
          <a class="btn" href="{{ url_for('upload') }}">Upload now</a>
          <a class="btn btn--ghost" href="{{ url_for('premium_subscribe') }}">BUY ME A CUP OF COFFEE</a>
        </div>
      </div>
      <div class="home-banner__exchange" aria-hidden="true">
        <lottie-player
          src="/static/banners/file-share-loop-2.json"
          background="transparent"
          speed="1"
          loop
          autoplay
          aria-hidden="true">
        </lottie-player>
      </div>
    </div> 
  </section>

  <!-- <main class="page-shell">
    {% if not current_user %}
    <section class="landing-hero">
      <div class="container hero-inner landing-grid">
        <div class="hero-copy">
          <div class="pill">Create, share, inspire</div>
          <h1 class="mega-title">
            <span class="hl">Build with clarity,</span>
            <span class="hl hl--soft">present with calm,</span>
            <span class="hl">share with ease.</span>
            <span class="hl hl--soft">Your ideas, beautifully.</span>
          </h1>
          <p class="muted lead">Upload, organize, and showcase decks without friction. Clean previews, smooth downloads, and a space where your work looks its best.</p>
          <form class="hero-search" action="{{ url_for('search') }}" method="get">
            <label class="sr-only" for="landing-search">Search</label>
            <input id="landing-search" name="q" type="search" placeholder="Search 25M presentations, people, topics" value="{{ request.query_params.get('q', '') }}" aria-label="Search" />
            <button type="submit">Submit search</button>
          </form>
          <div class="hero-actions">
            <a class="btn" href="{{ url_for('login') }}">Sign in</a>
            <a class="btn btn--ghost" href="{{ url_for('register') }}">Start uploading</a>
            <span class="muted" style="font-size:13px;">EN</span>
          </div>
          <div class="quick-links">
            <span>Polished pitch decks</span>
            <span>Research made clear</span>
            <span>Design-forward slides</span>
            <span>Stories worth sharing</span>
          </div>
        </div>
        <div class="hero-visual">
          <div class="hero-illustration">
            <div class="hero-logo">Fileshare</div>
            <div class="hero-shape hero-shape--one"></div>
            <div class="hero-shape hero-shape--two"></div>
            <div class="hero-shape hero-shape--three"></div>
            <div class="hero-card">
              <div class="badge">AI</div>
              <div class="hero-card-title">Off to a flying start.</div>
              <p class="muted">Use AI to rewrite, rephrase, or simplify existing slide content.</p>
            </div>
          </div>
        </div>
      </div>
    </section> -->

    <section class="container promo-split">
      <div class="promo-left">
        <h2 class="promo-title">All your decks in one calm, beautiful place.</h2>
        <p class="muted">Share confidently, collaborate smoothly, and keep every version tidy.</p>
        <div class="promo-highlight">Glowing cards that slide side-to-side so you can peek at each focus area.</div>
      </div>
      <div class="promo-right">
        <div class="promo-controls" aria-hidden="false">
          <button class="promo-nav" type="button" data-promo-prev aria-label="Scroll cards left">‚Üê</button>
          <button class="promo-nav" type="button" data-promo-next aria-label="Scroll cards right">‚Üí</button>
        </div>
        <div class="promo-track" data-promo-track>
          <article class="plan-card plan-card--glow">
            <div class="plan-header plan-header--cool">Why teams choose us</div>
            <div class="plan-body">
              <ul>
                <li>Crisp previews for slides, docs, and PDFs</li>
                <li>Clean downloads without clutter</li>
                <li>Simple sharing for teammates and clients</li>
                <li>Spaces that keep every file in order</li>
              </ul>
              <div class="plan-cta">
                <a class="btn" href="{{ url_for('register') }}">Start sharing</a>
              </div>
            </div>
          </article>

          <article class="plan-card plan-card--glow">
            <div class="plan-header plan-header--warm">Built for creators</div>
            <div class="plan-body">
              <ul>
                <li>Upload once, share everywhere</li>
                <li>Readable typography and balanced layouts</li>
                <li>Organize by project, client, or topic</li>
              </ul>
              <div class="plan-cta">
                <a class="btn btn--ghost" href="{{ url_for('login') }}">Browse community decks</a>
              </div>
            </div>
          </article>
        </div>
      </div>
    </section>

    <section class="container trust-strip">
      <div class="trust-item">
        <div class="mini-icon" aria-hidden="true">üîç</div>
        <div>
          <div class="trust-title">Search that feels smart</div>
          <p class="muted">Surface the right decks fast with topics, people, and tags.</p>
        </div>
      </div>
      <div class="trust-item">
        <div class="mini-icon" aria-hidden="true">‚¨áÔ∏è</div>
        <div>
          <div class="trust-title">Downloads without friction</div>
          <p class="muted">Keep formats intact‚ÄîPPT, PDF, and docs stay presentation-ready.</p>
        </div>
      </div>
      <div class="trust-item">
        <div class="mini-icon" aria-hidden="true">‚ú®</div>
        <div>
          <div class="trust-title">Polish your story</div>
          <p class="muted">Clear typography and balanced layouts put your ideas first.</p>
        </div>
      </div>
      <div class="trust-item">
        <div class="mini-icon" aria-hidden="true">‚òÅÔ∏è</div>
        <div>
          <div class="trust-title">Stay organized</div>
          <p class="muted">Projects, clients, and topics stay tidy in one calm space.</p>
        </div>
      </div>
    </section>

    {% if cu %}
    <section class="container feature-panel">
      <div class="panel-head">
        <h2 class="section-title">Build once. Share everywhere.</h2>
        <p class="muted">Keep a single, beautiful source of truth for every idea.</p>
      </div>
      <div class="category-grid">
        {% for cat in ["Business","Mobile","Social Media","Marketing","Technology","Art & Photos","Career","Design"] %}
          <a class="category-chip" href="/search?q={{ cat|urlencode }}">{{ cat }}</a>
        {% endfor %}
      </div>
    </section>
    {% endif %}

    <section class="container slide-marquee">
      <div class="panel-head">
        <h3 class="section-title">Trending today</h3>
        <p class="muted">Peek at what the community is reading.</p>
      </div>
      <div class="marquee-row">
        {% set sample_slides = [
          {"title": "Telemedicine ppt", "author": "khandhar", "views": "171.5K", "badge": "PPTX"},
          {"title": "Health information systems (his)", "author": "Nkosinathi Lungu", "views": "59.2K", "badge": "PPTX"},
          {"title": "Quality Assurance in Hospitals", "author": "Nc Das", "views": "169.8K", "badge": "PPTX"},
          {"title": "Medical records ppt", "author": "Sudipto Karmakar", "views": "226.7K", "badge": "PPTX"},
          {"title": "Management of shock", "author": "khadeejakhurshid", "views": "133.4K", "badge": "PPT"},
          {"title": "Medico legal case", "author": "Nc Das", "views": "269.6K", "badge": "PPT"},
          {"title": "Burns management", "author": "SCGH ED CME", "views": "186.5K", "badge": "PPTX"},
          {"title": "Finding & Validating Startup/Product Ideas", "author": "Ujjwal Trivedi", "views": "990", "badge": "PDF"}
        ] %}
        <div class="marquee-track">
          {% for slide in sample_slides %}
          <article class="slide-card">
            <div class="badge">{{ slide.badge }}</div>
            <div class="slide-title">{{ slide.title }}</div>
            <p class="muted">by {{ slide.author }} ¬∑ {{ slide.views }} views</p>
          </article>
          {% endfor %}
        </div>
      </div>
    </section> 

   <section class="container visual-gallery">
      <div class="panel-head">
        <h3 class="section-title">See the slides before you click</h3>
        <p class="muted">A quick look at popular decks people are saving right now.</p>
      </div>
      <div class="gallery-grid">
        {% for i in range(6) %}
          <div class="gallery-card">
            <img src="{{ request.url_for('static', path='slide-placeholder.png') }}" alt="Slide preview {{ i + 1 }}">
            <div class="gallery-meta">
              <span class="badge">PPTX</span>
              <span class="muted">{{ ["Business","Design","AI","Marketing","Health","Career"][i % 6] }}</span>
            </div>
          </div>
        {% endfor %}
      </div>
    </section>

    <section class="container feature-panel two-up">
      <div class="feature-card">
        <h3 class="section-title">Confident delivery</h3>
        <p class="muted">Crisp previews and distraction-free layouts keep your audience focused.</p>
      </div>
      <div class="feature-card">
        <h3 class="section-title">Reusable building blocks</h3>
        <p class="muted">Save sections, reuse slides, and stay consistent across projects.</p>
      </div>
    </section>

    <section class="container feature-panel two-up">
      <div class="feature-card">
        <h3 class="section-title">Always ready to share</h3>
        <p class="muted">Links, downloads, and embeds that look great anywhere you send them.</p>
      </div>
      <div class="feature-card">
        <h3 class="section-title">Organize with ease</h3>
        <p class="muted">Group decks by team or topic and keep everything tidy without extra effort.</p>
      </div>
    </section>

    <section class="container pricing-grid">
      <div class="plan-card">
        <div class="pill">For individuals</div>
        <h3>Share beautifully, without the noise</h3>
        <ul>
          <li>Clean previews for every upload</li>
          <li>Reliable downloads in original formats</li>
          <li>Simple links for sharing anywhere</li>
        </ul>
        <a class="btn" href="{{ url_for('register') }}">Start now</a>
        <p class="muted" style="margin-top:8px;">Keep creating‚Äîno clutter, no pressure.</p>
      </div>
      <div class="plan-card plan-card--ghost">
        <div class="pill">For teams</div>
        <h3>Keep every deck aligned</h3>
        <ul>
          <li>Organize by project or client</li>
          <li>Share with teammates in seconds</li>
          <li>Stay consistent with reusable sections</li>
        </ul>
        <a class="btn btn--ghost" href="{{ url_for('login') }}">Explore together</a>
        <p class="muted" style="margin-top:8px;">Made for collaboration, not upsells.</p>
      </div>
    </section>

    <section class="container upload-cta">
      <div class="upload-card">
        <div>
          <p class="pill">Upload</p>
          <h3>Your big ideas deserve an audience.</h3>
          <p class="muted">Upload a presentation and share your know-how with the world.</p>
          <a class="btn" href="{{ url_for('register') }}">Upload a presentation</a>
          <p class="muted" style="margin-top:8px;">Supported: PPT, PPTX, PPSX, POTX, PDF, DOC, DOCX.</p>
        </div>
        <div class="cloud-logos muted">
          <span>Upload from another service:</span>
          <div class="cloud-row">
            <span class="cloud-chip">Google Drive</span>
            <span class="cloud-chip">Box</span>
            <span class="cloud-chip">OneDrive</span>
          </div>
        </div>
      </div>
    </section>

    <section class="container faq-panel">
      <div class="panel-head">
        <h3 class="section-title">Frequently asked questions</h3>
      </div>
      <div class="faq-list">
        <div class="faq-item">
          <div class="faq-q">What is Fileshare?</div>
          <div class="faq-a">A community of 5M users sharing 10M presentations on any topic.</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">Do I need a subscription?</div>
          <div class="faq-a">No. Start with an ad-supported experience or try premium free for 30 days.</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">What is included in a subscription?</div>
          <div class="faq-a">Original downloads, AI-assisted rewriting, ad-free usage, and richer discovery.</div>
        </div>
        <div class="faq-item">
          <div class="faq-q">How do I cancel?</div>
          <div class="faq-a">You can cancel anytime within settings‚Äîtrial runs for 30 days.</div>
        </div>
      </div>
    </section>
    {% else %}

    <section class="container dashboard-hero">
      <div>
        <p class="muted" style="text-transform:uppercase; letter-spacing:1px; font-size:12px;">Welcome back</p>
        <h1 class="section-title" style="font-size:28px;">Here are the latest uploads from the community.</h1>
        <div class="auth-actions" style="margin-top:12px;">
          <a class="btn" href="{{ url_for('upload') }}">Upload</a>
          <a class="btn btn--ghost" href="{{ url_for('search') }}">Search everything</a>
        </div>
      </div>
      <div class="signed-in-metrics">
        <div>
          <div class="metric-value">{{ presentations|length }}</div>
          <div class="muted">Total presentations</div>
        </div>
        <div>
          <div class="metric-value">10M+</div>
          <div class="muted">Ideas to explore</div>
        </div>
      </div>
    </section>

    <!-- Community uploads: public view -->
    <section class="container community-uploads" style="margin-top:18px;">
      <div class="panel-head">
        <h3 class="section-title">Latest uploads</h3>
        <p class="muted">Recent files uploaded by the community. Click to view or download.</p>
      </div>
      <div class="grid" style="grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:12px; margin-top:10px;">
        {% for pres in presentations %}
        {% set is_pdf = pres.filename and pres.filename.lower().endswith('.pdf') %}
        {% set slide_thumb = '/presentations/' ~ pres.id ~ '/slide/0' %}
        {% set thumb_pdf = '/download/' ~ pres.filename ~ '?inline=1#page=1&view=FitH&toolbar=0&navpanes=0' if is_pdf else None %}
        {% set cover_or_pdf = pres.cover_url or thumb_pdf or request.url_for('static', path='slide-placeholder.svg') %}
        <article class="card" data-pid="{{ pres.id }}">
          <a href="{{ url_for('view_presentation', presentation_id=pres.id) }}" class="card__link">
            <div class="card__thumb">
              {% if is_pdf %}
              <iframe class="thumb-frame" src="{{ cover_or_pdf }}" title="{{ pres.title }} preview" loading="lazy" data-cover="{{ pres.cover_url or '' }}"></iframe>
              {% else %}
              <img src="{{ slide_thumb }}" alt="{{ pres.title }}" data-cover="{{ pres.cover_url or '' }}" data-placeholder="{{ request.url_for('static', path='slide-placeholder.svg') }}">
              {% endif %}
            </div>
            <div class="card__body">
              <h4>{{ pres.title }}</h4>
              <p class="muted">by {% if pres.owner_username %}<a href="/users/{{ pres.owner_username }}">{{ pres.owner_username }}</a>{% else %}{{ (('User ' ~ pres.owner_id) if pres.owner_id else (pres.author or 'Unknown')) }}{% endif %}</p>
            </div>
          </a>
          <div class="card__actions">
            <a class="btn btn--ghost" href="{{ url_for('view_presentation', presentation_id=pres.id) }}">Open</a>
            <a class="btn" href="{{ url_for('download_file', filename=pres.filename) }}">Download</a>
          </div>
        </article>
        {% else %}
        <p class="muted">No uploads yet. Be the first to <a href="{{ url_for('upload') }}">upload</a>.</p>
        {% endfor %}
      </div>
    </section>

    <section class="container layout-two-col" style="margin-top:12px;">
      <div>
        <div class="content-card" style="margin-top:0;">
          <div class="content-head">
            <h2>Featured & Trending</h2>
            <a class="muted" href="{{ url_for('search') }}">See all</a>
          </div>
          <div class="grid" style="margin-top:16px;">
            {% for pres in presentations %}
            {% set is_pdf = pres.filename and pres.filename.lower().endswith('.pdf') %}
            {% set slide_thumb = '/presentations/' ~ pres.id ~ '/slide/0' %}
            {% set thumb_pdf = '/download/' ~ pres.filename ~ '?inline=1#page=1&view=FitH&toolbar=0&navpanes=0' if is_pdf else None %}
            {% set cover_or_pdf = pres.cover_url or thumb_pdf or request.url_for('static', path='slide-placeholder.svg') %}
            <article class="card">
              <a href="{{ url_for('view_presentation', presentation_id=pres.id) }}" class="card__link">
                <div class="card__thumb">
                  {% if is_pdf %}
                  <div class="thumb-frame thumb-frame--pdf" data-pdf="{{ cover_or_pdf }}" data-cover="{{ pres.cover_url or '' }}">
                    <canvas class="thumb-canvas" aria-label="{{ pres.title }} preview"></canvas>
                    <object data="{{ cover_or_pdf }}" data-thumb="{{ cover_or_pdf }}" type="application/pdf" class="thumb-object" aria-label="{{ pres.title }} preview"></object>
                  </div>
                  {% else %}
                  <img src="{{ slide_thumb }}" alt="{{ pres.title }}" data-cover="{{ pres.cover_url or '' }}" data-placeholder="{{ request.url_for('static', path='slide-placeholder.svg') }}">
                  {% endif %}
                </div>
                <div class="card__body">
                  <h3>{{ pres.title }}</h3>
                  <p class="muted">{{ pres.author or 'Unknown' }}{% if pres.views is not none %} ¬∑ {{ pres.views }} views{% endif %}</p>
                </div>
              </a>
              <div class="card__actions">
                <button class="btn btn--ghost preview-btn" data-preview-id="{{ pres.id }}">Preview</button>
                <a class="btn" href="{{ url_for('view_presentation', presentation_id=pres.id) }}">Open</a>
              </div>
            </article>
            {% else %}
            <p class="muted">No presentations yet. Be the first to <a href="{{ url_for('upload') }}">upload</a>.</p>
            {% endfor %}
          </div>
        </div>

        <div class="content-card">
          <div class="content-head">
            <h3>Latest Uploads</h3>
            <a class="muted" href="{{ url_for('upload') }}">Add yours</a>
          </div>
          <div class="grid" style="grid-template-columns:repeat(auto-fill,minmax(220px,1fr));">
            {% for pres in presentations[:8] %}
            {% set is_pdf = pres.filename and pres.filename.lower().endswith('.pdf') %}
            {% set slide_thumb = '/presentations/' ~ pres.id ~ '/slide/0' %}
            {% set thumb_pdf = '/download/' ~ pres.filename ~ '?inline=1#page=1&view=FitH&toolbar=0&navpanes=0' if is_pdf else None %}
            {% set cover_or_pdf = pres.cover_url or thumb_pdf or request.url_for('static', path='slide-placeholder.svg') %}
            <article class="card">
              <a href="{{ url_for('view_presentation', presentation_id=pres.id) }}" class="card__link">
                <div class="card__thumb">
                  {% if is_pdf %}
                  <iframe class="thumb-frame" src="{{ cover_or_pdf }}" title="{{ pres.title }} preview" loading="lazy" data-cover="{{ pres.cover_url or '' }}"></iframe>
                  {% else %}
                  <img src="{{ slide_thumb }}" alt="{{ pres.title }}" data-cover="{{ pres.cover_url or '' }}" data-placeholder="{{ request.url_for('static', path='slide-placeholder.svg') }}">
                  {% endif %}
                </div>
                <div class="card__body">
                  <h4>{{ pres.title }}</h4>
                  <p class="muted">{{ pres.author or 'Unknown' }}</p>
                </div>
              </a>
              <div class="card__actions">
                <button class="btn btn--ghost preview-btn" data-preview-id="{{ pres.id }}">Preview</button>
                <a class="btn" href="{{ url_for('view_presentation', presentation_id=pres.id) }}">Open</a>
              </div>
            </article>
            {% else %}
            <p class="muted">Uploads will appear here as soon as content is added.</p>
            {% endfor %}
          </div>
        </div>
      </div>

      <aside class="sidebar">
        <div class="content-card">
          <h4>Top Topics</h4>
          <ul class="muted">
            <li><a href="/search?q=AI">AI & Machine Learning</a></li>
            <li><a href="/search?q=marketing">Marketing Strategy</a></li>
            <li><a href="/search?q=design">Product Design</a></li>
            <li><a href="/search?q=leadership">Leadership</a></li>
            <li><a href="/search?q=education">Education</a></li>
          </ul>
        </div>
        <div class="content-card premium-card">
          <div class="pill">Tips</div>
          <h3 style="margin:8px 0 6px 0;">Share with confidence.</h3>
          <p class="muted" style="margin:0 0 10px 0;">Keep your best slides close, reuse them, and stay on-message across every deck.</p>
          <div class="auth-actions" style="margin-top:6px;">
            <a class="btn" href="{{ url_for('upload') }}">Upload now</a>
            <a class="btn btn--ghost" href="{{ url_for('register') }}">Join the community</a>
          </div>
        </div>
      </aside>
    </section>
    {% endif %}
  </main>

  <div id="preview-modal" class="preview-modal hidden">
    <div class="preview-backdrop" data-preview-close></div>
    <div class="preview-dialog">
      <div class="preview-head">
        <div>
          <div class="preview-title" id="preview-title">Preview</div>
          <div class="preview-status muted" id="preview-status"></div>
        </div>
        <button class="preview-close" type="button" data-preview-close aria-label="Close preview">√ó</button>
      </div>
      <div class="preview-body" id="preview-body">
        <div class="preview-placeholder" id="preview-placeholder">
          <div class="pill pill--tiny">Preview</div>
          <p class="muted" style="margin:8px 0 0 0;">Loading first page‚Ä¶</p>
        </div>
        <canvas id="preview-canvas" class="file-preview file-preview--canvas" aria-label="Presentation preview"></canvas>
        <object id="preview-object" class="file-preview" type="application/pdf" aria-label="Presentation preview fallback"></object>
        <div class="preview-message hidden" id="preview-message"></div>
      </div>
      <div class="preview-actions" id="preview-actions">
        <a id="preview-open" class="btn" href="#" target="_blank" rel="noopener">Open full view</a>
        <a id="preview-download" class="btn btn--ghost" href="#" download>Download original</a>
      </div>
    </div>
  </div>

  <footer class="site-footer">
    <div class="container footer-grid">
      <div>
        <a class="brand" href="{{ url_for('index') }}">Fileshare</a>
        <p class="muted">Share presentations, find ideas.</p>
      </div>
      <div>
        <h4>Get in touch</h4>
        <div class="cta-stack" style="margin-top:8px; gap:8px; flex-direction:column; align-items:flex-start;">
          <a class="btn" href="{{ url_for('about') }}">About us</a>
          <a class="btn btn--ghost" href="{{ url_for('contact') }}">Contact</a>
          <a class="btn btn--ghost" href="{{ url_for('help') }}">Help</a>
        </div>
      </div>
      <div>
        <h4>Company</h4>
        <ul>
          <li><a href="{{ url_for('about') }}">About</a></li>
          <li><a href="#">Careers</a></li>
        </ul>
      </div>
      <div>
        <h4>Support</h4>
        <ul>
          <li><a href="{{ url_for('help') }}">Help Center</a></li>
          <li><a href="{{ url_for('contact') }}">Contact</a></li>
        </ul>
      </div>
      <div>
        <h4>Legal</h4>
        <ul>
          <li><a href="/terms">Terms</a></li>
          <li><a href="/privacy">Privacy</a></li>
        </ul>
      </div>
    </div>
    <div class="container footer-bar">¬© {{ current_year or 2025 }} FileShare</div>
  </footer>

  <script src="{{ request.url_for('static', path='js/main.js') }}"></script>
</body>
</html>
